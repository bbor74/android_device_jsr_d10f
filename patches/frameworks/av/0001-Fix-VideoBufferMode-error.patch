From 0954178817f32231b67de70a81f27749f045e7ca Mon Sep 17 00:00:00 2001
From: Boris Belyaev <bbor1974@gmail.com>
Date: Wed, 25 Oct 2023 15:26:45 +0400
Subject: [PATCH] Fix VideoBufferMode error

E CameraClient: setVideoBufferMode: 592: videoBufferMode 2 is not supported.

Change-Id: I7d70b6cb9924f60c9150fa23886cce267f2b1d22
---
 media/libmediaplayerservice/StagefrightRecorder.cpp           | 2 +-
 media/libstagefright/include/media/stagefright/CameraSource.h | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/media/libmediaplayerservice/StagefrightRecorder.cpp b/media/libmediaplayerservice/StagefrightRecorder.cpp
index c58dcb9b0..795f20d7d 100644
--- a/media/libmediaplayerservice/StagefrightRecorder.cpp
+++ b/media/libmediaplayerservice/StagefrightRecorder.cpp
@@ -1581,7 +1581,7 @@ status_t StagefrightRecorder::setupCameraSource(
         *cameraSource = CameraSource::CreateFromCamera(
                 mCamera, mCameraProxy, mCameraId, mClientName, mClientUid, mClientPid,
                 videoSize, mFrameRate,
-                mPreviewSurface);
+                mPreviewSurface, false);
     }
     mCamera.clear();
     mCameraProxy.clear();
diff --git a/media/libstagefright/include/media/stagefright/CameraSource.h b/media/libstagefright/include/media/stagefright/CameraSource.h
index d6149c0f7..b0fedf2f4 100644
--- a/media/libstagefright/include/media/stagefright/CameraSource.h
+++ b/media/libstagefright/include/media/stagefright/CameraSource.h
@@ -90,7 +90,7 @@ public:
                                           Size videoSize,
                                           int32_t frameRate,
                                           const sp<IGraphicBufferProducer>& surface,
-                                          bool storeMetaDataInVideoBuffers = true);
+                                          bool storeMetaDataInVideoBuffers = false);
 
     virtual ~CameraSource();
 
-- 
2.17.1

